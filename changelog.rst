Changelog
============================


3.0 Release Candidate 2 released
------------------------------------------------

.. post:: 2016-06-19
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-RC2``, release date 2016-06-19

Two bugfixes. No changes in format or API

Changes:

- Fixed #726: DBMaker.volumeDB broken

- HTreeMap expiration could throw ``DBException.GetVoid``. Fixed by using lazy iterators in ``IndexTreeLongLongMap``


3.0 Release Candidate 1 released
-------------------------------------------

.. post:: 2016-06-07
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-RC1``, release date 2016-06-06

Number of small improvements. At this point MapDB has no obvious bugs.
If no bugs are found this version will become stable release.

No changes in format or API.

Changes:

- added ``Store.fileLoad()`` method. Content of memory mapped file can be loaded into memory by ``db.getStore().fileLoad()``

- added ``DBMaker.allocationIncrement()`` to minimize number of memory mapped chunks.  This is workaround for *too many file handles*, see `#723 <https://github.com/jankotek/mapdb/issues/723>`_

- Added documentation

- Rework close methods to be thread safe, do not throw exception on second close.

- Make ``Store.commit()`` and ``Store.rollback()`` thread safe.

- BTreeMap: external values were not deleted after removal

- Store: add ``getAllFiles()`` method.

- Update Elsa serialization library


3.0 beta5 released
---------------------------

.. post:: 2016-05-24
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-beta5``, release date 2016-05-24

This release is fixing data corruption caused by ``StoreWAL`` with transactions enabled. Update is strongly recommended.

No changes in format or API.


3.0 beta4 released
---------------------------

.. post:: 2016-05-19
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-beta4``, release date 2016-05-19

**FORMAT CHANGE** POJO serializer format has changed. If you use default serializer together with your own objects, your data might not be readable.
Well known java classes in ``java.lang`` such as ``String``, ``Long``, ``BigDecimal`` etc are not affected.

Changes:

- reworked Elsa serialization (default serializer) to fix Class Catalog issues.

- Elsa serializer now uses ``IdentityHashMap`` for recursive references. Much faster serialization for large object graphs

- Rework JVM shutdown hook and ``DB.close()``, should fix #706.

- JVM Shutdown hook now uses single thread for all DBs (memory efficient for many DBs with shutdown hook registered).

- JVM Shutdown hook now uses hard reference instead of ``WeakReference``. There is new option in DBMaker to use weak ref.

- Fix ``BTreeMap.put`` caused ``ArrayIndexOutOfBoundsException``. Fix #707

- ``BTreeMap.prefixSubmap`` now works with more primitive arrays (``int[]``, ``long[]`` etc..). Credit Dmitriy Shabanov

- fix various small issues to make acceptance tests pass

- Kotlin updated to 1.0.2

- HTreeMap has new options to clear map content with expiration triggers. See #708.

3.0 beta3 released
---------------------------------

.. post:: 2016-05-08
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-beta3``, release date 2016-05-08

Fixed performance in HTreeMap, user serializers and file locking.

No changes in storage format or API.

Changes:

- DB: throw IllegalAccessError on access after DB was closed

- DB: make serializers optional in name catalog

- ``DB.fileLockDisable()`` would not work. Fixed

- Added option ``DB.fileLockWait()`` to block until file lock is released by second JVM #693. There is optional timeout.

- HTreeMap and IndexTreeList default sizes were to small,
  list would throw assertion error after 64K records, HTreeMap was slow due to huge number of collisions.
  Default size changed from 64K to 1E9




3.0 beta2 released
-----------------------------------

.. post:: 2016-05-01
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-beta2``, release date 2016-05-01

This release is fixing **data corruption issue**. Compaction on ``StoreDirect`` will corrupt storage
if there is record smaller then 6 bytes (affects ``HTreeMap`` and ``BTreeMap``).

Second bugfix is on ``BTreeMap``, it would not call modification listeners.

No changes in storage format or API.


3.0 beta1 released
-------------------------------

.. post:: 2016-04-30
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-beta1``, release date 2016-04-28

First semi-stable release. Storage format and API (``DB``, ``DBMaker``) should be
stable from now on.

**Storage format change:**
Format has changed, files generated by M6 and older should not be opened with this version.


Milestone 6 released (2016-04-23)
--------------------------------------------

.. post:: 2016-04-23
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-M6``

- Fixed BTreeMap race condition `#664 <https://github.com/jankotek/mapdb/issues/664>`_.
- Improved POJO serialization (Elsa) dependency.
- MapDB now should handle and use class catalog.
- Added several tests to test concurrency
- Memory mapped file preclear no longer sync file. Faster file growth.

**Storage format change:**
Maximal record ID increased. Older storage format should be still readable.



Milestone 5 released (2016-04-14)
--------------------------------------------

.. post:: 2016-04-14
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-M5``

There are several new options ported from 2.0 branch. Transactions are disabled by default,
use `DBMaker.transactionEnable()` to enable it.

There is `a new blog post </news/migrating_to_30/>`_ for 2.0 users who would like to use new 3.0 branch


3.0.0 Milestone 4 released (2016-03-28)
--------------------------------------------

.. post:: 2016-03-28
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-M4``

M4 fixes Store reopen `issue <https://github.com/jankotek/mapdb/issues/680>`_.


3.0.0 Milestone 3 released (2016-03-10)
--------------------------------------------

.. post:: 2016-03-10
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-M3``

Next release towards stable 3.0. Some features are not yet implemented, most notably memory mapped files and transactions.

3.0.0 Milestone 2 released (2016-02-12)
--------------------------------------------

.. post:: 2016-02-12
   :tags: release
   :author: Jan

Maven version number: ``3.0.0-M3``

This version adds BTreeMap



MapDB 1 and 2
----------------

Older changelog is in `archive <../changelog-archive>`_