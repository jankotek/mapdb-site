<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Changelog for 2.X releases &mdash; MapDB</title>
    
    <link rel="stylesheet" href="../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MapDB" href="../" />
  
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

<!-- google analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42074659-1', 'auto');
  ga('send', 'pageview');

</script>

  
  <link rel="alternate" type="application/atom+xml"  href="../blog/atom.xml" title="MapDB Blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../">Home</a></li>
    <li><a href="../doc/getting-started/">Intro</a></li>
    <li><a href="../doc/">Docs</a></li>
    <li><a href="../blog/">Blog</a></li>
    <li><a href="https://github.com/jankotek/mapdb">Github</a></li>
  </ul>
  <div>
    <a href="../">
      <img src="../_static/logo.png" alt="MapDB" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Changelog for 2.X releases</a><ul>
<li><a class="reference internal" href="#beta13-released-2016-02-21">2.0-beta13 released (2016-02-21)</a></li>
<li><a class="reference internal" href="#beta12-released-2015-11-26">2.0-beta12 released (2015-11-26)</a></li>
<li><a class="reference internal" href="#beta11-released-2015-11-18">2.0-beta11 released (2015-11-18)</a></li>
<li><a class="reference internal" href="#beta10-released-2015-10-30">2.0-beta10 released (2015-10-30)</a></li>
<li><a class="reference internal" href="#beta9-released-2015-10-30">2.0-beta9 released (2015-10-30)</a></li>
<li><a class="reference internal" href="#beta8-released-2015-09-28">2.0-beta8 released (2015-09-28)</a></li>
<li><a class="reference internal" href="#beta7-released-2015-09-18">2.0-beta7 released (2015-09-18)</a></li>
<li><a class="reference internal" href="#beta6-released-2015-08-18">2.0-beta6 released (2015-08-18)</a></li>
<li><a class="reference internal" href="#beta5-released-2015-08-12">2.0 beta5 released (2015-08-12)</a></li>
<li><a class="reference internal" href="#version-2-0-beta4-2015-08-03">Version 2.0-beta4 (2015-08-03)</a></li>
<li><a class="reference internal" href="#version-2-0-beta3-2015-07-23">Version 2.0-beta3 (2015-07-23)</a></li>
<li><a class="reference internal" href="#version-2-0-beta2-2015-07-09">Version 2.0-beta2 (2015-07-09)</a></li>
<li><a class="reference internal" href="#version-2-0-beta1-2015-06-31">Version 2.0-beta1 (2015-06-31)</a></li>
<li><a class="reference internal" href="#version-2-0-alpha3-2015-06-16">Version 2.0-alpha3 (2015-06-16)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#changelog-for-1-x-releases">Changelog for 1.X releases</a><ul>
<li><a class="reference internal" href="#version-1-0-9-released-2016-02-21">Version 1.0.9 released (2016-02-21)</a></li>
<li><a class="reference internal" href="#version-1-0-8-2015-07-09">Version 1.0.8 (2015-07-09)</a></li>
<li><a class="reference internal" href="#version-1-0-7-2015-02-19">Version 1.0.7 (2015-02-19)</a></li>
<li><a class="reference internal" href="#version-1-0-6-2014-08-07">Version 1.0.6 (2014-08-07)</a></li>
<li><a class="reference internal" href="#version-1-0-5-2014-07-15">Version 1.0.5 (2014-07-15)</a></li>
<li><a class="reference internal" href="#version-1-0-4-2014-06-26">Version 1.0.4 (2014-06-26)</a></li>
<li><a class="reference internal" href="#version-1-0-3-2014-06-08">Version 1.0.3 (2014-06-08)</a></li>
<li><a class="reference internal" href="#version-1-0-2-2014-06-02">Version 1.0.2 (2014-06-02)</a></li>
<li><a class="reference internal" href="#version-1-0-1-2014-05-05">Version 1.0.1 (2014-05-05)</a></li>
<li><a class="reference internal" href="#version-1-0-0-2014-04-27">Version 1.0.0 (2014-04-27)</a></li>
<li><a class="reference internal" href="#version-0-9-13-2014-04-16">Version 0.9.13 (2014-04-16)</a></li>
<li><a class="reference internal" href="#version-0-9-12-2014-04-15">Version 0.9.12 (2014-04-15)</a></li>
<li><a class="reference internal" href="#version-0-9-11-2014-03-24">Version 0.9.11 (2014-03-24)</a></li>
<li><a class="reference internal" href="#version-0-9-10-2014-02-18">Version 0.9.10 (2014-02-18)</a></li>
<li><a class="reference internal" href="#version-0-9-9-2014-01-29">Version 0.9.9 (2014-01-29)</a></li>
<li><a class="reference internal" href="#version-0-9-8-2013-12-30">Version 0.9.8 (2013-12-30)</a></li>
<li><a class="reference internal" href="#version-0-9-7-2013-10-28">Version 0.9.7 (2013-10-28)</a></li>
<li><a class="reference internal" href="#version-0-9-6-2013-09-27">Version 0.9.6 (2013-09-27)</a></li>
<li><a class="reference internal" href="#version-0-9-5-2013-08-26">Version 0.9.5 (2013-08-26)</a></li>
<li><a class="reference internal" href="#version-0-9-4-2013-08-09">Version 0.9.4 (2013-08-09)</a></li>
<li><a class="reference internal" href="#version-0-9-3-2013-06-02">Version 0.9.3 (2013-06-02)</a></li>
<li><a class="reference internal" href="#version-0-9-2-2013-05-19">Version 0.9.2 (2013-05-19)</a></li>
<li><a class="reference internal" href="#version-0-9-1-2013-04-14">Version 0.9.1 (2013-04-14)</a></li>
<li><a class="reference internal" href="#version-0-9-0-2013-04-01">Version 0.9.0 (2013-04-01)</a></li>
<li><a class="reference internal" href="#upgrade-urgency-levels">Upgrade urgency levels:</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/changelog-archive.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="changelog-for-2-x-releases">
<h1>Changelog for 2.X releases<a class="headerlink" href="#changelog-for-2-x-releases" title="Permalink to this headline">¶</a></h1>
<div class="section" id="beta13-released-2016-02-21">
<h2>2.0-beta13 released (2016-02-21)<a class="headerlink" href="#beta13-released-2016-02-21" title="Permalink to this headline">¶</a></h2>
<p>Fixed some minor issues. Probably last 2.0 release, 3.0 is coming soon.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #656, HTreeMap.isEmpty() broken with counter enabled.</li>
<li>SerializerPojo#registerClass cannot handle interfaces: NullPointerException in getFields. Fix #653</li>
<li>StoreWAL: handle case when write cache becomes inconsistent if commit dies.</li>
<li>StoreCached: fix NPE if compaction is called with dirty write cache</li>
<li>BTreeKeySerializers are now trusted. Performance improvement. #636</li>
<li>StoreDirect: remove parallel compaction</li>
<li>StoreCached: fix head initialization after compaction</li>
<li>WAL: do not log exception, just warning in case of incomplete WAL</li>
<li>Serializer; remove broken ZIGZAG serializers</li>
<li>Fix #621. Use special engine, which removes file on close.</li>
<li>Maps: add modification listeners that fire after locks have been released #613</li>
<li>Serializer: compression wrappers had incorrect equal and hashCode</li>
<li>Spurious NullPointerException when closing soft/weak cache , fix #648</li>
</ul>
</div>
<div class="section" id="beta12-released-2015-11-26">
<h2>2.0-beta12 released (2015-11-26)<a class="headerlink" href="#beta12-released-2015-11-26" title="Permalink to this headline">¶</a></h2>
<p>There are no breaking changes. Fixed data corruption in large stores.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/635">#635</a>: Commit on large store could cause data corruption in index table.</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/634">#634</a>: Empty commit with Append store would log warning and could cause data corruption</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/633">#633</a>: Compaction on large store fails. (thanks Matthew Schirmer for fixing it)</li>
<li>DBMaker: add <code class="docutils literal"><span class="pre">fileMmapPreclearDisable()</span></code> option to speedup growth of memory mapped files.</li>
</ul>
</div>
<div class="section" id="beta11-released-2015-11-18">
<h2>2.0-beta11 released (2015-11-18)<a class="headerlink" href="#beta11-released-2015-11-18" title="Permalink to this headline">¶</a></h2>
<p>There are no breaking changes. Fixed data corruption bug and concurrency issue in <code class="docutils literal"><span class="pre">StoreAppend</span></code></p>
<p>Changes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">StoreAppend</span></code> had data corruption issue. Files larger than 16MB would get corrupted. This issue might have affected <code class="docutils literal"><span class="pre">StoreWAL</span></code> as well, but it is now fixed for both cases.</li>
<li><code class="docutils literal"><span class="pre">StoreAppend</span></code> had race condition. Fixed with temporary hot fix, which lowers performance. Working on profer fix.</li>
<li>Small API changes and Javadoc fixes for better 1.0 compatibility</li>
</ul>
</div>
<div class="section" id="beta10-released-2015-10-30">
<h2>2.0-beta10 released (2015-10-30)<a class="headerlink" href="#beta10-released-2015-10-30" title="Permalink to this headline">¶</a></h2>
<p>There is <strong>breaking storage format change</strong>. This version will fail to open store created by 2.0-beta8 and previous versions.</p>
<p>Changes:</p>
<ul class="simple">
<li>Write Ahead Log was refactored into dedicated class. <code class="docutils literal"><span class="pre">StoreWAL</span></code> and <code class="docutils literal"><span class="pre">StoreAppend</span></code> now share this component.</li>
<li>WAL rewritten, now uses checksums</li>
<li>WAL has soft replay, commits will be faster once this feature is fully enabled.</li>
<li><cite>StoreWAL`</cite> and <code class="docutils literal"><span class="pre">StoreAppend</span></code> now passes crash resistance test (<code class="docutils literal"><span class="pre">kill</span> <span class="pre">-9</span></code>).</li>
<li>Fixed unit tests on Windows</li>
<li>Updated maven plugins and automated release script.</li>
<li>4 new release flavours (mapdb-renamed, mapdb-noassert, mapdb-nounsafe, mapdb-debug)</li>
<li><code class="docutils literal"><span class="pre">StoreDirect</span></code> long stack uses better compression for longs.</li>
<li><code class="docutils literal"><span class="pre">StoreDirect</span></code> improved memory allocator</li>
<li>Fix #583. HTreeMap valueCreator was used, even if value existed.</li>
</ul>
</div>
<div class="section" id="beta9-released-2015-10-30">
<h2>2.0-beta9 released (2015-10-30)<a class="headerlink" href="#beta9-released-2015-10-30" title="Permalink to this headline">¶</a></h2>
<p>This release does not exist, number was used to test release script.</p>
</div>
<div class="section" id="beta8-released-2015-09-28">
<h2>2.0-beta8 released (2015-09-28)<a class="headerlink" href="#beta8-released-2015-09-28" title="Permalink to this headline">¶</a></h2>
<p>There is <strong>breaking storage format change</strong>. This version will fail to open store created by 2.0-beta7</p>
<p>Changes:</p>
<ul class="simple">
<li>Breaking storage format change</li>
<li>Fixed random data corruption which was affecting Titan and other users.</li>
<li>Fixed RandomAccessFile to always fully read <code class="docutils literal"><span class="pre">byte[]</span></code></li>
</ul>
</div>
<div class="section" id="beta7-released-2015-09-18">
<h2>2.0-beta7 released (2015-09-18)<a class="headerlink" href="#beta7-released-2015-09-18" title="Permalink to this headline">¶</a></h2>
<p>There is <strong>storage format change</strong>: <code class="docutils literal"><span class="pre">TreeSet</span></code> has different format. And <code class="docutils literal"><span class="pre">byte[]</span></code> used as key in BTreeMap
has format change due to changed comparator.</p>
<p>Changes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">TreeSet</span></code> is faster and more space efficient, but that causes breaking change in storage format.</li>
<li><code class="docutils literal"><span class="pre">Fun.BYTE_ARRAY_COMPARATOR</span></code> comparator treated negative byte as smaller than positive byte. New comparator treats
content of <code class="docutils literal"><span class="pre">byte[]</span></code> as unsigned, so 0xFF is bigger than 0x0F. Needed for better compatibility and string handling.
This causes breaking change if <code class="docutils literal"><span class="pre">byte[]</span></code> is used as a key in sorted map/set.</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/561">#561</a>, queues fails after compaction, when their preallocated recid disappears</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/562">#562</a>, BTreeMap/HTreeMap: make KeySet public and add sizeLong() method.</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/468">#468</a>, Queues: NPE on createCircularQueue</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/541">#541</a>, BTreeMap, HTreeMap: make maps and sets serializable using java serialization.</li>
<li>Modify POJO serialization to handle object <code class="docutils literal"><span class="pre">writeReplace()</span></code> method. See <a class="reference external" href="https://github.com/jankotek/mapdb/issues/495">#495</a></li>
<li>Performance: HTreeMap code sliced into several smaller methods, more JIT friendly.</li>
<li>BTreeMap: fix composite keys, fix <code class="docutils literal"><span class="pre">TreeMap_Composite_Key</span></code> example</li>
<li>TxEngine: fix null handling in CAS.</li>
<li>DBMaker: fileMmapEnableIfSupported() does not support 64bit Windows anymore</li>
<li>StoreWAL: compaction broken, remove compaction if transactions are enabled.</li>
<li>Volume: fix clear method</li>
<li>Fix <a class="reference external" href="https://github.com/jankotek/mapdb/issues/581">#581</a>, BTreeMap: get() did not followed link, was broken under concurrent update.</li>
</ul>
</div>
<div class="section" id="beta6-released-2015-08-18">
<h2>2.0-beta6 released (2015-08-18)<a class="headerlink" href="#beta6-released-2015-08-18" title="Permalink to this headline">¶</a></h2>
<p>There is <strong>storage format change</strong>: array hashing has changed. If you use any array such as <code class="docutils literal"><span class="pre">Object[]</span></code>, <code class="docutils literal"><span class="pre">byte[]</span></code>,
<code class="docutils literal"><span class="pre">long[]</span></code>, etc... as key in <code class="docutils literal"><span class="pre">HashMap</span></code> it is not readable in new version.</p>
<p>Hashing in Java is broken. <code class="docutils literal"><span class="pre">Arrays.hash()</span></code> and <code class="docutils literal"><span class="pre">String.hashCode()</span></code> returns too many collisions.
This version replaces Java hashing with XXHash and other improved algorithms.</p>
<p>This version also fixes number of bugs. <code class="docutils literal"><span class="pre">BTreeMap</span></code> with <code class="docutils literal"><span class="pre">valuesOutsideNodesEnable()</span></code> had storage space leak,
now it uses much less space and is faster with updates.</p>
<p>Changes:</p>
<ul class="simple">
<li>Hash code calculation has changed in: <code class="docutils literal"><span class="pre">Serializer.OBJECT_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.BYTE_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.BYTE_ARRAY_NOSIZE</span></code>,
<code class="docutils literal"><span class="pre">Serializer.CHAR_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.INT_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.LONG_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.DOUBLE_ARRAY</span></code>,
<code class="docutils literal"><span class="pre">Serializer.FLOAT_ARRAY</span></code>, <code class="docutils literal"><span class="pre">Serializer.SHORT_ARRAY</span></code> and <code class="docutils literal"><span class="pre">Serializer.RECID_ARRAY</span></code>,</li>
<li>Hash did not changed in <code class="docutils literal"><span class="pre">Serializer.STRING</span></code>, it still uses <code class="docutils literal"><span class="pre">String.hashCode()</span></code>. But this
hash is broken and for HashMap Key Serializer one should use new <code class="docutils literal"><span class="pre">Serializer.STRING_XXHASH</span></code></li>
<li>XXHash64 hash from LZ4-Java project was integrated into MapDB (Volume, DataIO, UnsafeStuff...). Will be fully utilized in next release</li>
<li>Some serializers now use Hash Seed. That is better protection from Hash Collision attack.</li>
<li>There is new experimental <code class="docutils literal"><span class="pre">StoreArchive</span></code>. It is faster, uses less space, but only readonly storage.
Its not finished, and next release WILL change its storage format. For details checkout
<a class="reference external" href="https://github.com/jankotek/mapdb/issues/93">bug report</a></li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/403">#403</a>. BTreeMap: storage space leak with valuesOutsideNodesEnable()
Old external values were not deleted on update and removal from BTreeMap. Now this case is much faster on updates</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/430">#430</a>. Fun: Fun.filter should use the comparator of the filtered set.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/546">#546</a>. Rewrote persistent Serializers in <code class="docutils literal"><span class="pre">DB</span></code>. Fixed some warnings.</li>
<li>Added <code class="docutils literal"><span class="pre">Store.fileLoad()</span></code> to pre-cache file content of mmap files</li>
<li>Added <code class="docutils literal"><span class="pre">DBMaker.CC()</span></code> to access Compiler Config at runtime.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/385">#385</a>. Untrusted serializers are now limited and can not read beyong record size.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/556">#556</a>. CircularQueue fails to take 1 element if queue is of size 4 and not full.</li>
<li>Started work on BTreeMap online compaction, no working code yet. See
<a class="reference external" href="https://github.com/jankotek/mapdb/issues/545">#545</a> and <a class="reference external" href="https://github.com/jankotek/mapdb/issues/97">#97</a></li>
</ul>
</div>
<div class="section" id="beta5-released-2015-08-12">
<h2>2.0 beta5 released (2015-08-12)<a class="headerlink" href="#beta5-released-2015-08-12" title="Permalink to this headline">¶</a></h2>
<p>Added incremental backups. Less fragmentation. Custom class loaders.</p>
<p>Changes:</p>
<ul class="simple">
<li>MapDB now has full and incremental backups. Checkout examples for details:
<a class="reference external" href="https://github.com/jankotek/mapdb/blob/master/src/test/java/examples/Backup.java">full</a> and
<a class="reference external" href="https://github.com/jankotek/mapdb/blob/master/src/test/java/examples/Backup_Incremental.java">incremental</a></li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/mapdb/issues/555">#555</a>. Class Loader used by POJO serialization is now customizable.
Checkout <code class="docutils literal"><span class="pre">DBMaker.serializerClassLoader()</span></code> and <code class="docutils literal"><span class="pre">DBMaker.serializerRegisterClass()</span></code> methods</li>
<li>Reuse recid is now enabled by default. This causes smaller fragmentation.</li>
</ul>
</div>
<div class="section" id="version-2-0-beta4-2015-08-03">
<h2>Version 2.0-beta4 (2015-08-03)<a class="headerlink" href="#version-2-0-beta4-2015-08-03" title="Permalink to this headline">¶</a></h2>
<p>Improvements in crash recovery. Reworked HTreeMap expiration based on store size. Add store allocation options.</p>
<p>Changes:</p>
<ul class="simple">
<li>Improved crash recovery with mmap files.</li>
<li>Store now reports free space correctly.</li>
<li>HTreeMap expiration based on maximal storage size now works much better. Checkout
<a class="reference external" href="https://github.com/jankotek/mapdb/blob/master/src/test/java/examples/CacheOffHeapAdvanced.java">example</a>
for details.</li>
<li>Add <code class="docutils literal"><span class="pre">DBMaker.allocateStartSize()</span></code> and <code class="docutils literal"><span class="pre">DBMaker.allocateIncrement()</span></code> options to control initial store size
and how store size increments.</li>
<li>StoreDirect and StoreWAL had bug within compaction. That is now fixed.</li>
<li>Optimize RandomAccessFile and mmap file Volumes. IO should be bit faster.</li>
<li>Fixed POJO serialization on Android 4.2+ devices.</li>
</ul>
</div>
<div class="section" id="version-2-0-beta3-2015-07-23">
<h2>Version 2.0-beta3 (2015-07-23)<a class="headerlink" href="#version-2-0-beta3-2015-07-23" title="Permalink to this headline">¶</a></h2>
<p>Bug fix in Write Ahead Log. Added file locking. Crash recovery improved but still needs more testing.
Not sure if disk compaction and commits works on Windows with mmap files.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fixed issue in Write-Ahead-Log. Single record modified by many commit would not be persisted after full replay.</li>
<li>Added file locking to prevent multiple processes opening the same store. By default it uses <code class="docutils literal"><span class="pre">FileChannel.lock()</span></code>
There are two new options: <code class="docutils literal"><span class="pre">DBMaker.fileLockDisable()</span></code> to disable locking, and ``</li>
<li>many new stress tests</li>
<li>Fixed: StoreAppend.get() throws <code class="docutils literal"><span class="pre">NullPointerException</span></code> with transaction disabled.</li>
<li>More changes into mmap files. Improve handling in case of low-disk space.</li>
</ul>
</div>
<div class="section" id="version-2-0-beta2-2015-07-09">
<h2>Version 2.0-beta2 (2015-07-09)<a class="headerlink" href="#version-2-0-beta2-2015-07-09" title="Permalink to this headline">¶</a></h2>
<p>Lot of bugfixing. Cleaner Hack for mmap files is disabled now. It is recommended <strong>not to use mmap files on Windows
for now, until we do proper investigation</strong>.
This release also provides <code class="docutils literal"><span class="pre">mapdb-renamed</span></code> maven package, with package name renamed to <code class="docutils literal"><span class="pre">org.mapdb20</span></code></p>
<p>Improved crash recovery for Write Ahead Log and Append Only stores. In some cases MapDB would not replay log,
on start after JVM crash. This could potentially lead to data corruption. Crash recovery is still not perfect
and will need future improvements.</p>
<p>Memory mapped files could cause JVM crash, for details see <a class="reference external" href="https://github.com/jankotek/mapdb/issues/442">Issue 442</a>.
Crash would happen if write to mapped <code class="docutils literal"><span class="pre">ByteBuffer</span></code> would fail for some reasons (empty disk space).
It could also happen if unmapped buffer was accessed.</p>
<p>There were number of changes to solve this issue. Most importantly now <strong>MapDB 2.0 now has cleaner hack
disabled by default</strong>. File handles are not released until Garbage Collection occur. This might
cause file handle leaks. On Windows it prevents compaction and commits, since old file is locked and can not be renamed.
There is new option <code class="docutils literal"><span class="pre">DBMaker.fileMmapCleanerHackEnable()</span></code> to enable Cleaner Hack and release file handle
when DB is closed.</p>
<p>Other changes:</p>
<ul class="simple">
<li>Race condition between  <code class="docutils literal"><span class="pre">StoreDirect.put()</span></code> and <code class="docutils literal"><span class="pre">StoreDirect.compact()</span></code> is now fixed,
for details see <a class="reference external" href="https://github.com/jankotek/mapdb/issues/542">Issue 542</a>. As result
StoreDirect is now exclusively locked during compaction. With transaction disabled data can not be read or updated,
while compaction is running.
Performance improvement should be in next release.</li>
<li>Build script now produces separate jar file with package renamed to <code class="docutils literal"><span class="pre">org.mapdb20</span></code> and Maven name changed to
<code class="docutils literal"><span class="pre">mapdb-renamed</span></code>. This should make it easy to use multiple versions in single JVM and migrate data between them.</li>
<li><code class="docutils literal"><span class="pre">Serializer.JAVA</span></code> serializer did not work. Fixed #536.</li>
<li><code class="docutils literal"><span class="pre">Bind.histogram()</span></code> would not recreate empty secondary set. Fix #453.</li>
<li>HTreeMap: fix #538, NullPointerException when <code class="docutils literal"><span class="pre">HTreeMap.get()</span></code> was called with non existing key while overflow was enabled</li>
<li>Fix custom serializers ignored on map creation #540</li>
</ul>
</div>
<div class="section" id="version-2-0-beta1-2015-06-31">
<h2>Version 2.0-beta1 (2015-06-31)<a class="headerlink" href="#version-2-0-beta1-2015-06-31" title="Permalink to this headline">¶</a></h2>
<p>Storage format and API freeze. Fixed concurrent race conditions and crashes. Storage format has changed since Alpha3.
More details about this release in the <a class="reference external" href="http://kotek.net/blog/MapDB_2_beta_1">blog post</a></p>
<p>List of possible problems:</p>
<ul class="simple">
<li>Crash recovery for Write-Ahead-Log and compaction is not completely verified. Data should be safe, but recovery might require user intervention to delete some old files etc.</li>
<li>MMap files could <a class="reference external" href="https://github.com/jankotek/mapdb/issues/442">cause JVM to crash</a>. Older 1.0 branch also has this bug, it should be fixed in two weeks in 1.0.8 and 2.0-beta2.</li>
<li>AppendOnly store does not have compaction. It also needs more testing for crash recovery.</li>
<li>Several performance optimizations are disabled. Stability over speed is preferred. Many parts could be 4x faster, but those optimizations are postponed to 2.1 release. However 2.0 is still much faster compared to 1.0 release.</li>
</ul>
</div>
<div class="section" id="version-2-0-alpha3-2015-06-16">
<h2>Version 2.0-alpha3 (2015-06-16)<a class="headerlink" href="#version-2-0-alpha3-2015-06-16" title="Permalink to this headline">¶</a></h2>
<p>Last unstable version before beta release.</p>
</div>
</div>
<div class="section" id="changelog-for-1-x-releases">
<h1>Changelog for 1.X releases<a class="headerlink" href="#changelog-for-1-x-releases" title="Permalink to this headline">¶</a></h1>
<div class="section" id="version-1-0-9-released-2016-02-21">
<h2>Version 1.0.9 released (2016-02-21)<a class="headerlink" href="#version-1-0-9-released-2016-02-21" title="Permalink to this headline">¶</a></h2>
<p>No breaking changes. Fixed some minor issues. Probably last 1.0 release, 3.0 is coming soon.</p>
<p>Changes:</p>
<blockquote>
<div><ul class="simple">
<li>BTreeMap: found a race condition. Not going to fix. #664</li>
<li>SerializerPojo: Additional way to load class from ClassLoader. Fix #620</li>
<li>Volume: check against null value before forcing updates to be written #639</li>
<li>Maps: Backport sizeLong() methods to 1.x</li>
<li>SerializerPojo#registerClass cannot handle interfaces: NullPointerException in getFields. Fix #653</li>
<li>File resources are never released after a thread is interrupted when using asyncWriteEnable(), Fix #490</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="version-1-0-8-2015-07-09">
<h2>Version 1.0.8 (2015-07-09)<a class="headerlink" href="#version-1-0-8-2015-07-09" title="Permalink to this headline">¶</a></h2>
<p>Fixed several bugs.</p>
<p>Changes:</p>
<blockquote>
<div><ul class="simple">
<li>Memory Mapped files could cause JVM crash (<code class="docutils literal"><span class="pre">~StubRoutines::jlong_disjoint_arraycopy</span></code>).
For details see <a class="reference external" href="https://github.com/jankotek/mapdb/issues/442">Issue 442</a>.
This was linked to ByteBuffer Cleaner Hack which unmaps buffer when file is closed,
rather than waiting to Garbage Collection. Cleaner Hack was disabled by default in 2.0.
In 1.0 it is left enabled for compatibility reason. There is new setting
<code class="docutils literal"><span class="pre">DBMaker.mmapFileCleanerHackDisable()</span></code> to disable it, in case you experience problems.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/452">#452</a>: <code class="docutils literal"><span class="pre">pumpSource()</span></code> would fails with empty iterator</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/453">#453</a>: <code class="docutils literal"><span class="pre">Bind.histogram()</span></code> does not recreate content if secondary collection is empty</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/362">#362</a>: failing unit tests on Windows</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/517">#517</a>: DB: non serializable serializer could leave name catalog in semi-locked state</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/513">#513</a>: Atomic.Var: store does not allow <code class="docutils literal"><span class="pre">null</span></code> values. Change initial value from <cite>null</cite> to empty string <cite>&#8220;&#8221;</cite>.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/523">#523</a>: Read-only mmap file not unmapped after close.</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/534">#534</a>: BTreeMap: IndexOutOfBoundsException under concurrent access</li>
<li><code class="docutils literal"><span class="pre">mapdb-renamed</span></code> was update to 1.0.8. There is script to make release semi-automated</li>
</ul>
</div></blockquote>
<p>Open issues</p>
<blockquote>
<div><ul class="simple">
<li>there are reported isses with data corruption in Write-Ahead-Log.
Most notably <a class="reference external" href="https://github.com/jankotek/MapDB/issues/509">#509</a> and <a class="reference external" href="https://github.com/jankotek/MapDB/issues/515">#515</a>.
I can not reproduce it yet, but working on fixing those.</li>
<li>List of <a class="reference external" href="https://github.com/jankotek/mapdb/labels/1.0">open issues in 1.0 branch</a>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="version-1-0-7-2015-02-19">
<h2>Version 1.0.7 (2015-02-19)<a class="headerlink" href="#version-1-0-7-2015-02-19" title="Permalink to this headline">¶</a></h2>
<p>Fixed bugs in Write-Ahead-Log and <code class="docutils literal"><span class="pre">HTreeMap</span></code> entry expiration.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fixed serializer for newer android versions. <a class="reference external" href="https://github.com/koa/MapDB/commit/da938caac36f807c9f737ec6b06c7b4d72a91a2a">Link</a></li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/443">#443</a> In-memory compaction does not delete temp files</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/442">#442</a> DirectByteBuffer unmapping and Async Write could cause JVM crash on compaction and commit</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/419">#419</a> DB.getHashSet() does not restore expiration settings</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/418">#418</a> HTreeMap expiration was broken</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/400">#400</a> HTreeMap.get() resets TTL to zero in some cases</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/417">#417</a> Infinite loop in Store.calculateStatistics()</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/374">#374</a> Map value creator is never called!</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/414">#414</a> Snapshots were not working under some conditions</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/381">#381</a> WAL corruption with deletes</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/364">#364</a> WAL corruption with async writes</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/373">#373</a> SerializerPojo throws NotSerializableException for Class field</li>
<li>Fixed <a class="reference external" href="https://github.com/jankotek/MapDB/issues/445">#445</a> Race condition in Hashtable cache caused ClassCastException</li>
</ul>
<p>Open issues:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/jankotek/MapDB/labels/1.0">A few</a> I could not replicate.</li>
</ul>
</div>
<div class="section" id="version-1-0-6-2014-08-07">
<h2>Version 1.0.6 (2014-08-07)<a class="headerlink" href="#version-1-0-6-2014-08-07" title="Permalink to this headline">¶</a></h2>
<p>Fixed problem in transaction log replay after unclean shutdown WAL
checksum was broken, so it was disabled.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #359: WAL log replay could fail after unclean shutdown</li>
<li>Workaround #366: WAL checksum was broken, disable WAL checksum.</li>
</ul>
</div>
<div class="section" id="version-1-0-5-2014-07-15">
<h2>Version 1.0.5 (2014-07-15)<a class="headerlink" href="#version-1-0-5-2014-07-15" title="Permalink to this headline">¶</a></h2>
<p>Fixed transaction log replay failure. Fixed race condition in async
writes. Some methods changed from protected to public, to allow external
access.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #346: WAL log corruption when killing the mapdb process.
Discarding corrupted log was not reliable.</li>
<li>Fix #356: <code class="docutils literal"><span class="pre">asyncWriteEnable()</span></code> had race condition in record
preallocation. Could result to data loss. Feature is too complex to
fix, so was removed. Expect minor performance regression.</li>
<li>Fix DB: TreeMap Pump keyExtractor was not used. Would cause problem
with Tuple2 pairs</li>
<li>Fix #358: set correct hasher when open exist hash tree map</li>
<li>Atomic classes now expose recid via public <code class="docutils literal"><span class="pre">getRecid()</span></code> method</li>
<li>DB now exposes Name Catalog via public methods. External libraries
can manipulate catalog content.</li>
</ul>
</div>
<div class="section" id="version-1-0-4-2014-06-26">
<h2>Version 1.0.4 (2014-06-26)<a class="headerlink" href="#version-1-0-4-2014-06-26" title="Permalink to this headline">¶</a></h2>
<p>Fixed transaction file locking on Windows.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #326, #327, #346 and #323: Transaction log was not unlocked on
Windows, causing various issues. Kudos to Rémi Alvergnat for
discovering and fixing it.</li>
<li>Fix #335: Ensures that file resources are always released on close.
Kudos to Luke Butters.</li>
</ul>
</div>
<div class="section" id="version-1-0-3-2014-06-08">
<h2>Version 1.0.3 (2014-06-08)<a class="headerlink" href="#version-1-0-3-2014-06-08" title="Permalink to this headline">¶</a></h2>
<p>Fixed new space allocation problem, file now increases in 1MB
increments. Updated copyright info and added notice.txt</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #338 Excess storage size on Memory mapped files</li>
<li>Add notice.txt with list of copyright holders</li>
<li>Updated javadocs</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access.
Unconfirmed and can not reproduce. It needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-1-0-2-2014-06-02">
<h2>Version 1.0.2 (2014-06-02)<a class="headerlink" href="#version-1-0-2-2014-06-02" title="Permalink to this headline">¶</a></h2>
<p>Fixed <code class="docutils literal"><span class="pre">Serializer.CompressionWrapper()</span></code>, this bug does not affect
<code class="docutils literal"><span class="pre">DBMaker.compressionEnable()</span></code></p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #321: Small behaviour regression in BTreeMap Pump</li>
<li>Fix #332: <code class="docutils literal"><span class="pre">Serializer.CompressionWrapper()</span></code> decompressed wrong
data. Reverted some optimization which caused this issue.</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access.
Unconfirmed and can not reproduce. It needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-1-0-1-2014-05-05">
<h2>Version 1.0.1 (2014-05-05)<a class="headerlink" href="#version-1-0-1-2014-05-05" title="Permalink to this headline">¶</a></h2>
<p>Fixed MRU cache and BTree Pump Presort.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #320: BTreeMap pump presort fails</li>
<li>Fix #319: ClassCastException in the Cache.LRU</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access.
Unconfirmed and can not reproduce. It needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-1-0-0-2014-04-27">
<h2>Version 1.0.0 (2014-04-27)<a class="headerlink" href="#version-1-0-0-2014-04-27" title="Permalink to this headline">¶</a></h2>
<p>Fixed a few minor problems. Lot of code cleanups.</p>
<p>This is first stable release with long term support. Thanks to everyone
who helped to get MapDB this far.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #315: DB.delete(name) deletes substring matches</li>
<li>SerializerPojo: add interceptors to alter serialized objects</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access.
Unconfirmed and can not reproduce. It needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-0-9-13-2014-04-16">
<h2>Version 0.9.13 (2014-04-16)<a class="headerlink" href="#version-0-9-13-2014-04-16" title="Permalink to this headline">¶</a></h2>
<p>There was another problem with mmap files larger than 2GB.</p>
<p>This is yet another release candidate for 1.0.0. Stable release should
follow in 9 days if no problems are found.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #313: mmap files larger than 2GB could not be created</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access: .
Unconfirmed and needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-0-9-12-2014-04-15">
<h2>Version 0.9.12 (2014-04-15)<a class="headerlink" href="#version-0-9-12-2014-04-15" title="Permalink to this headline">¶</a></h2>
<p>Previous release was broken, store larger than 16 MB or 2 GB could not
be created, that is fixed now. This release also brings number of small
cleanups and improved memory consumption.</p>
<p>The store format has changed yet again in backward incompatible way. The
chunk (slice) size is now 1 MB.</p>
<p>This is yet another release candidate for 1.0.0. Stable release should
follow in 10 days if no problems are found.</p>
<p>Changes:</p>
<ul class="simple">
<li>Format change! Chunk (slice) size reduced from 16MB to 1MB, solved
many Out Of Memory errors.</li>
<li>Fix #313: mmap files larger than 2GB could not be created</li>
<li>Fix #308: ArrayIndexOutOfBoundsException if store is larger 16MB.</li>
<li>Fix #312: error while opening db with readonly</li>
<li>Fix #304: BTreeMap.replace() fails under concurrent access</li>
<li>Large scale code cleanup before 1.0.0 freeze and release</li>
<li>DBMaker: rename <code class="docutils literal"><span class="pre">syncOnCommitDisable()</span></code> to
<code class="docutils literal"><span class="pre">commitFileSyncDisable()</span></code></li>
<li>DBMaker: add <code class="docutils literal"><span class="pre">newHeapDB()</span></code> option, this store does not use
serialization and is almost as fast as java collections</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access: .
Unconfirmed and needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-0-9-11-2014-03-24">
<h2>Version 0.9.11 (2014-03-24)<a class="headerlink" href="#version-0-9-11-2014-03-24" title="Permalink to this headline">¶</a></h2>
<p>This fixes serious race condition for in-memory store. Also there is fix
for secondary collections containing wrong values. And finally all file
locking problems on Windows should be solved.</p>
<p>As result the store format was completely changed. There is no backward
compatibility with previous releases. MapDB now allocates memory in 16MB
chunks (slices), so new empty database will always consume a few MB of
memory/disk space.</p>
<p>This is last 0.9.x release, next release will be 1.0.0.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #303 and #302: There was race condition in Volumes, which caused
data corruption under concurrent access.</li>
<li>Fix #252 and #274: File locking on Windows is now completely solved.
We no longer use overlapping ByteBuffers which were source of errors.</li>
<li>Fix #297: BTreeMap modification listeners received wrong key. As
result secondary collections could contain wrong data.</li>
<li>Fix #300: <code class="docutils literal"><span class="pre">Queue.offer()</span></code> should return false, not throw an
<code class="docutils literal"><span class="pre">IllegalStateException()</span></code>. Not really isssue since MapDB does not
have queues with limited size yet.</li>
<li>Engine: add close listener, to prevent NPE on shutdown in HTreeMap
Cache</li>
<li>Maven: do not run tests in parallel, it causes out of memory errors</li>
<li>StoreWAL: do not delete log file after every commit, keep it around.
This should speedup commits a lot</li>
<li>Volume: mmap file chunks (slices) were synced multiple times, causing
slow sync and commits</li>
<li>Volume: change &#8216;chunk size&#8217; (slice size) from 1GB to 16MB and disable
incremental allocation.</li>
<li>DBMaker: The &#8216;full chunk allocation&#8217; option was removed and is now on
by default.</li>
<li>DBMaker: method <code class="docutils literal"><span class="pre">newDirectMemoryDB()</span></code> replaced with
<code class="docutils literal"><span class="pre">newMemoryDirectDB()</span></code></li>
<li>Fun: Added Tuple5 and Tuple6 support</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #304 and #283: BTreeMap fails under concurrent access: .
Unconfirmed and needs more investigation.</li>
<li>Documentation</li>
</ul>
</div>
<div class="section" id="version-0-9-10-2014-02-18">
<h2>Version 0.9.10 (2014-02-18)<a class="headerlink" href="#version-0-9-10-2014-02-18" title="Permalink to this headline">¶</a></h2>
<p>Yet another bug fix release before 1.0. There is fix for serious data
corruption with disabled transactions. Async-Writer queue is no longer
unbounded to prevent memory leaks. In-memory cache is now much easier to
use with memory size limit, checkout
<code class="docutils literal"><span class="pre">Map</span> <span class="pre">cache</span> <span class="pre">=</span> <span class="pre">DBMaker.newCache(sizeLimitInGB)</span></code></p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #261: SerializerPojo could cause data corruption with transaction
disabled.</li>
<li>Fix #281: txMaker.makeTx().snapshot() does not work.</li>
<li>Fix #280: Check for parent folder when opening file db.</li>
<li>Fix #288: syncOnCommitDisable() does not work at WAL</li>
<li>Fix #276: In-memory cache based on HTreeMap now has memory size
limit. Checkout <code class="docutils literal"><span class="pre">Map</span> <span class="pre">cache</span> <span class="pre">=</span> <span class="pre">DBMaker.newCache(sizeLimitInGB)</span></code></li>
<li>Fix #282: DB.createXXX() does not throw exception if collection
already exists.</li>
<li>Fix #275: AsyncWrite fails with OOM error, Async Write Queue has now
limited size</li>
<li>Fix #272: Memory leak when using closeOnJvmShutdown (eg. any tmp map)</li>
<li>BTreeMap.containsKey is now faster with valuesOutsideNodes</li>
<li>Store: Fix invalid checksum computation with compress enabled</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Documentation</li>
<li>Small performance issues</li>
</ul>
</div>
<div class="section" id="version-0-9-9-2014-01-29">
<h2>Version 0.9.9 (2014-01-29)<a class="headerlink" href="#version-0-9-9-2014-01-29" title="Permalink to this headline">¶</a></h2>
<p>This release should be release candidate for 1.0. However serious issues
are still being discovered, and documentation is not in releasable
state. From now on I will probably roll out 0.9.10, 11, 12 and so every
week after every major bugfix. 1.0 should be released in a few weeks
after bugs &#8216;go away&#8217; and documentation is ready.</p>
<p>This release fixes broken TxMaker, concurrent transactions would always
generate false modification conflict. TreeSet in BTreeMap was also
seriously broken, it would not handle deletes, I had to change TreeSet
format to fix it. Write Ahead Transactions were broken and could
sometime corrupt log, solution requires WAL format change. Also
compaction on store was broken.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #259: BTreeMap &amp; TreeSet returns incorrect values after entries
were deleted.</li>
<li>Fix #258: StoreWAL: rewrite LongStack to solve misaligned page sizes.</li>
<li>Fix #262: TxMaker concurrent transaction always fails with conflict</li>
<li>Fix #265: Compaction was broken</li>
<li>Fix #268: Pump.buildTreeMap does not set a default comparator</li>
<li>Fix #266: Serialization fail on Advanced Enums</li>
<li>Fix #264: Fix NPA if store fails to open</li>
<li>BTreeMap: add meta-information to BTree nodes to support counted
BTree and per-node aggregations in future.</li>
</ul>
<p>Open problems:</p>
<ul class="simple">
<li>Open #261: SerializerPojo causes data corruption under some
conditions. This is not yet confirmed and can not be reproduced.
<a class="reference external" href="https://github.com/jankotek/MapDB/issues/261">https://github.com/jankotek/MapDB/issues/261</a></li>
</ul>
</div>
<div class="section" id="version-0-9-8-2013-12-30">
<h2>Version 0.9.8 (2013-12-30)<a class="headerlink" href="#version-0-9-8-2013-12-30" title="Permalink to this headline">¶</a></h2>
<p>This release is considered &#8216;beta&#8217;, API and store format should be now
frozen. Append-Only store and Store Pump are not part of MapDB for now.
Random Access File is enabled by default.</p>
<p>This release changes store format and is not backward compatible. There
are also several API changes. Also some new features are added.</p>
<p>Changes:</p>
<ul class="simple">
<li>Append-Only store was postponed to 1.1 release. All methods are not
public now.</li>
<li>Pump between stores was postponed to 1.1 release. All methods are not
public now.</li>
<li>Random Access File is now default option. Memory Mapped Files can be
enabled with <code class="docutils literal"><span class="pre">DBMaker.mmapFileEnable()</span></code></li>
<li>Refactor: Utils class removed</li>
<li>Refactor: <code class="docutils literal"><span class="pre">Bind.findValsX()</span></code> renamed to <code class="docutils literal"><span class="pre">Fun.filter()</span></code></li>
<li>StoreDirect and WAL format changes.</li>
<li>Jar is now annotated as OSGIi bundle, some classloader fixes.</li>
<li>StoreWAL commit speedup</li>
<li>Pump sorting now handles duplicates.</li>
<li>Fix #247: could not reopen collections with size counter.</li>
<li>Fix #249: SerializerPojo was not rolled back.</li>
<li>Non-existing DB.getXX() on read-only store now returns readonly empty
collection</li>
<li>BTreeKeySerializer now supplies serializers</li>
<li>Serializer gives fixed size hint</li>
<li>Bind: add reverse binding and secondary keys for maps</li>
<li>Adler32 checksum replaced with stronger CRC32.</li>
<li>Fix #237, StoreAppend dont close volume on corrupted file</li>
<li>Fix #237, assertion fails with archived records</li>
<li>HTreeMap: use Hasher for collection hashes.</li>
<li>Fix #232: POJO serialization broken on complex object graphs</li>
<li>Fix #229: compression was not working.</li>
<li><code class="docutils literal"><span class="pre">DB.createTreeMap()</span></code> and <code class="docutils literal"><span class="pre">DB.createHashMap()</span></code> now uses builder</li>
</ul>
</div>
<div class="section" id="version-0-9-7-2013-10-28">
<h2>Version 0.9.7 (2013-10-28)<a class="headerlink" href="#version-0-9-7-2013-10-28" title="Permalink to this headline">¶</a></h2>
<p>Store format is not backward compatible. Fixed locking issues on
Windows. Concurrent Transactions (TxMaker) reworked and finally fixed.
Added <code class="docutils literal"><span class="pre">DBMaker.fullChunkAllocationEnable()</span></code> to enable disk space
allocation in 1GB chunks. In-memory store now can be compacted. Fixed
race condition in <code class="docutils literal"><span class="pre">BTreeMap.put()</span></code>.</p>
<p>Changes:</p>
<ul class="simple">
<li>Rework integer/long serialization.</li>
<li>Fix #214: Queues now implement <code class="docutils literal"><span class="pre">BlockingQueue</span></code> interface</li>
<li>Refactor <code class="docutils literal"><span class="pre">DBMaker</span></code> so it uses properties. Easy to load/save config.</li>
<li>TxMaker reworked, fixed concurrency issue.</li>
<li>StoreDirect &amp; WAL use stricter locking.</li>
<li>Fix #218 and #192, locking issues on Windows during compaction
solved.</li>
<li>Added Tuple comparators.</li>
<li>Fixed several issues in Data Pump.</li>
<li>Fix #187, Reference to named objects/collections should be
serializable</li>
<li>BTreeMap: fix #209, put operation was not thread safe.</li>
</ul>
</div>
<div class="section" id="version-0-9-6-2013-09-27">
<h2>Version 0.9.6 (2013-09-27)<a class="headerlink" href="#version-0-9-6-2013-09-27" title="Permalink to this headline">¶</a></h2>
<p>Concurrent Transactions (TxMaker) almost fixed. Backward incompatible
store format change. Snapshots are no longer enabled by default.</p>
<p>Open issues:</p>
<ul class="simple">
<li>Fix #201: failing test suggests that Concurrent Transactions contains
race condition.</li>
</ul>
<p>Changes:</p>
<ul class="simple">
<li>Concurrent Transactions were broken and are now completely
re-written.</li>
<li>Snapshots are no longer enabled by default.
<code class="docutils literal"><span class="pre">DbMaker.snapshotDisable()</span></code> replaced by
<code class="docutils literal"><span class="pre">DbMaker.snapshotEnable()</span></code></li>
<li>StoreDirect now has checksum which refuses to reopen incorrectly
closed stores. In result stores created with 0.9.5- can not be open.</li>
<li>Store now supports recid preallocation, this leads to faster insert.</li>
<li>Fixed performance issue with batch imports</li>
<li>Fixed performance issues in free space management</li>
<li>Volume has lighter exception handling, result is small speed
improvement</li>
<li>StoreHeap rewritten. Now it has full transactions.</li>
<li>Changes in locking to make it more robust and prevent deadlocks</li>
<li>Java Assertions used instead of <code class="docutils literal"><span class="pre">IllegalArgumentException</span></code> and
<code class="docutils literal"><span class="pre">InternalError</span></code>. Please use <code class="docutils literal"><span class="pre">-ea</span></code> JVM switch when running MapDB</li>
<li>SerializerBase: various optimizations so methods fits into JIT limits</li>
</ul>
</div>
<div class="section" id="version-0-9-5-2013-08-26">
<h2>Version 0.9.5 (2013-08-26)<a class="headerlink" href="#version-0-9-5-2013-08-26" title="Permalink to this headline">¶</a></h2>
<p>Bugfixes from previous release. Fixed data corruption bugs, upgrade
strongly recommended.</p>
<p>Changes:</p>
<ul class="simple">
<li>Fix #177: broken compression</li>
<li>Fix data corruption with disabled transactions</li>
<li>CRC32 replaced with faster Adler32, <strong>store which uses checksum is no
backward compatible</strong></li>
<li>Fix #167: Add DB.exists() method to check if named record/collection</li>
<li>Fix #167: Add a makeOrGet to DB Collection maker API.</li>
<li>StoreWAL: fix some TOMBSTONE details</li>
<li>Bind: Add methods to find subsets on composite sets</li>
</ul>
</div>
<div class="section" id="version-0-9-4-2013-08-09">
<h2>Version 0.9.4 (2013-08-09)<a class="headerlink" href="#version-0-9-4-2013-08-09" title="Permalink to this headline">¶</a></h2>
<p><strong>No backward compability</strong> with previous versions. Some parts were
completely rewritten for better free space management. Many small
improvements.</p>
<p>Changes:</p>
<ul class="simple">
<li>HTreeMap now supports automatic LRU eviction based on size or access
time.</li>
<li>DB TreeMap, TreeSet and HashMap now uses builder class.</li>
<li>Reworked SerializerBase</li>
<li>Reworked Serializer implementations</li>
<li>Checksum, Compression and Encryption integrated into store, now much
faster</li>
<li>Add <code class="docutils literal"><span class="pre">.sizeLong()</span></code> into HTreeMap and BTreeMap.</li>
<li>Fixed data corruption in HTreeMap</li>
<li>Rewritten space reclaim algorithm</li>
<li>Store now has maximal size limit</li>
<li><code class="docutils literal"><span class="pre">DBMaker.writeAheadLogDisable()</span></code> renamed to
<code class="docutils literal"><span class="pre">DBMaker.transactionDisable()</span></code></li>
<li>TxMaker is now concurrent</li>
<li>BTreeMap now supports descending maps</li>
</ul>
</div>
<div class="section" id="version-0-9-3-2013-06-02">
<h2>Version 0.9.3 (2013-06-02)<a class="headerlink" href="#version-0-9-3-2013-06-02" title="Permalink to this headline">¶</a></h2>
<p>CRITICAL upgrade urgency. This release fixes number of critical bugs in
Write Ahead Log. It also adds support for advanced Java Serialization,
which was reported many times as a bug.</p>
<p>Changes:</p>
<ul class="simple">
<li>FIX Issue #17 - Serializer fails in some cases (writeExternal and
readExternal methods)</li>
<li>FIX Issue #136 &amp; #132 - Data corruption in Write Ahead Log after
rollback or reopen.</li>
<li>FIX Issue #137 - Deadlock while closing AsyncWriteEngine Credit Jan
Sileny</li>
<li>FIX Issue #139 - rolled back TX should not throw exception on close.</li>
<li>FIX Issue #135 - SerializerPojo registered classes problem. Credit
Jan Sileny</li>
<li>ADD <code class="docutils literal"><span class="pre">DBMaker.syncOnCommitDisable()</span></code> parameter</li>
<li>ADD all stuff in <code class="docutils literal"><span class="pre">DataIO.ByteArrayDataOutput</span></code> and <code class="docutils literal"><span class="pre">DataInput2</span></code> is
public. It also extends In/OutputStream now.</li>
</ul>
</div>
<div class="section" id="version-0-9-2-2013-05-19">
<h2>Version 0.9.2 (2013-05-19)<a class="headerlink" href="#version-0-9-2-2013-05-19" title="Permalink to this headline">¶</a></h2>
<p>CRITICAL upgrade urgency. This release fixes some critical bugs. It also
improves performance and introduces Data Pump.</p>
<p>Open Issues:</p>
<ul class="simple">
<li>Issue #17 - Serializer fails in some cases (writeExternal and
readExternal methods)</li>
</ul>
<p>Changes:</p>
<ul class="simple">
<li>FIX Issue #119 - BTreeMap did not released locks with multiple
transactions</li>
<li>FIX Issue #125 - calling close twice failed.</li>
<li>FIX race condition in HTreeMap</li>
<li>ADD <code class="docutils literal"><span class="pre">ByteBuffer</span></code> now uses <code class="docutils literal"><span class="pre">duplicate()</span></code> instead of
synchronization. Better concurrency</li>
<li>ADD Issue #123 - Replace RandomAccessFile by FileChannel and improve
performance on 32bit systems.</li>
<li>ADD Delta Packing for tuples</li>
<li>ADD better serialization for small strings</li>
<li>ADD improve Javadoc, use Pegdown Doclet so Javadoc can be written in
markdown</li>
<li>ADD reuse DataOutput instances, performance improvement</li>
<li>ADD datapump to create BTreeMap from large unsorted data set in
linear time. Checkout <code class="docutils literal"><span class="pre">Huge_Insert</span></code> example</li>
<li>ADD improve AsyncWriteEngine performance by removing Write Queue</li>
</ul>
</div>
<div class="section" id="version-0-9-1-2013-04-14">
<h2>Version 0.9.1 (2013-04-14)<a class="headerlink" href="#version-0-9-1-2013-04-14" title="Permalink to this headline">¶</a></h2>
<p>CRITICAL upgrade urgency. This release fixes number of critical bugs
from first release, including data store corruption and crashes.</p>
<p>Open issues:</p>
<ul class="simple">
<li>Issue #119 - BTreeMap (TreeMap) may not release all locks and
consequently crash. This is unconfirmed and hard to replicate
concurrent bug. I temporarily added assertion which slows down
BTreeMap updates, but helps to diagnose this problem</li>
<li>Issue #118 - StoreWAL fails to create log for unknown reasons and
crashes. Not reproduced yet, need to investigate.</li>
</ul>
<p>Changes:</p>
<ul class="simple">
<li>FIX #111 - Compaction fails with large data sets</li>
<li>FIX - BTreeKeySerializer.ZERO_OR_POSITIVE_INT was broken</li>
<li>FIX #89 - StoreAppend reopen failed</li>
<li>FIX #112 - Compaction fails with WAL enabled</li>
<li>FIX #114 - RandomAccessFile fails with WAL</li>
<li>FIX #113 - MemoryMappedFile was not unlocked on Windows after DB
close</li>
<li>FIX - rewrite AsynwWriteEngine, fix many concurrent bugs</li>
<li>FIX - Files were not synced on DB.close(). Possible data loss.</li>
<li>FIX - free space reuse did not worked in StoreDirect and StoreWAL.
Storage file grown infinitely with each update.</li>
<li>FIX #116 - HTreeMap.isEmpty returned wrong result.</li>
<li>FIX #121 - WAL could get corrupted in some cases.</li>
<li>ADD - basic benchmark</li>
<li>ADD - error message if file rename fails after compaction finishes</li>
<li>ADD - #119 BTreeMap locking could not be fixed, I added assertion to
help diagnose issue. Small performance drop on BTreeMap updates.</li>
<li>ADD - performance improvement if Snapshot engine is not used.</li>
</ul>
</div>
<div class="section" id="version-0-9-0-2013-04-01">
<h2>Version 0.9.0 (2013-04-01)<a class="headerlink" href="#version-0-9-0-2013-04-01" title="Permalink to this headline">¶</a></h2>
<p>First release with stable API and storage format.</p>
</div>
<div class="section" id="upgrade-urgency-levels">
<h2>Upgrade urgency levels:<a class="headerlink" href="#upgrade-urgency-levels" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>LOW: No need to upgrade unless there are new features you want to
use.</li>
<li>MODERATE: Program an upgrade of the DB engine, but it&#8217;s not urgent.</li>
<li>HIGH: There is a critical bug that may affect a subset of users.
Upgrade!</li>
<li>CRITICAL: There is a critical bug affecting MOST USERS. Upgrade ASAP.</li>
</ul>
</div>
</div>

  <div class="section">
  
  
  </div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, jan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>