<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Milestone 2 is out and 3.0 roadmap &mdash; MapDB</title>
    
    <link rel="stylesheet" href="../../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="MapDB" href="../../" />
  
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

<!-- google analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42074659-1', 'auto');
  ga('send', 'pageview');

</script>

  
  <link rel="alternate" type="application/atom+xml"  href="../../blog/atom.xml" title="MapDB Blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../../">Home</a></li>
    <li><a href="../../doc/getting-started/">Intro</a></li>
    <li><a href="../../doc/">Docs</a></li>
    <li><a href="../../blog/">Blog</a></li>
    <li><a href="https://github.com/jankotek/mapdb">Github</a></li>
  </ul>
  <div>
    <a href="../../">
      <img src="../../_static/logo.png" alt="MapDB" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Milestone 2 is out and 3.0 roadmap</a><ul>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#btreemap">BTreeMap</a></li>
<li><a class="reference internal" href="#sortedtablemap">SortedTableMap</a></li>
<li><a class="reference internal" href="#benchmarks">Benchmarks</a></li>
<li><a class="reference internal" href="#roadmap">3.0 Roadmap</a></li>
<li><a class="reference internal" href="#features-not-in-3-0">Features not in 3.0</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/news/m2_and_roadmap.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="milestone-2-is-out-and-3-0-roadmap">
<h1>Milestone 2 is out and 3.0 roadmap<a class="headerlink" href="#milestone-2-is-out-and-3-0-roadmap" title="Permalink to this headline">¶</a></h1>
<p>MapDB 3.0 milestone 2 was released today.
M2 adds BTreeMap, Data Pump and new faster SortedTableMap.</p>
<p>BTreeMap was reimplemented. New version is shorter, more compact
and probably more robust. It also handles iteration faster and
has faster range queries.</p>
<p>SortedTableMap is read-only and uses binary search over sorted table in file.
It is faster compared to BTreeMap and is designed to work well with Data Pump.</p>
<div class="section" id="links">
<h2>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h2>
<p>Maven dep for 3.0M2:</p>
<div class="code xml highlight-python"><div class="highlight"><pre><span></span>&lt;dependency&gt;
        &lt;groupId&gt;org.mapdb&lt;/groupId&gt;
        &lt;artifactId&gt;mapdb&lt;/artifactId&gt;
        &lt;version&gt;3.0.0-M2&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>
</div>
<p>Code examples are <a class="reference external" href="https://github.com/jankotek/mapdb/tree/mapdb3/mapdb-site/src/test/java/doc">here</a>.
Please keep on mind that DB can only be created, and can not be reopened yet.
<code class="docutils literal"><span class="pre">SortedTableMap</span></code> does not use DB and can be reopened.</p>
<p>Documentation for <code class="docutils literal"><span class="pre">SortedTableMap</span></code> is <a class="reference external" href="https://raw.githubusercontent.com/jankotek/mapdb/mapdb3/mapdb-site/doc/sortedtablemap.rst">on github</a>.</p>
</div>
<div class="section" id="btreemap">
<h2>BTreeMap<a class="headerlink" href="#btreemap" title="Permalink to this headline">¶</a></h2>
<p>Major news in BTreeMap is faster reverse iteration. Old version cached leaf nodes
and used <code class="docutils literal"><span class="pre">findSmaller</span></code> function to jump to next leaf node.
New reverse iteration code stores the directory nodes on stack, and greatly
reduces number of IO operations needed for reverse iteration.</p>
<p>Data Pump was redesigned. Now it takes data in ascending order (no longer reverse sorted).
Also source data do not have to be provided in an iterator. MapDB now provides <code class="docutils literal"><span class="pre">Consumer</span></code> callback interface
with <code class="docutils literal"><span class="pre">take</span></code> and <code class="docutils literal"><span class="pre">finish</span></code> methods. New Data Pump is much easier to use,
and accepts data from user loops, file parsers etc...</p>
<p>Major change in BTreeMap is <em>binary acceleration</em>. Old version suffered from
deserialization overhead and read amplification. To read single entry from leaf node,
it had to deserialize parent directory nodes to perform binary search.
This created many instances and generated lot of GC garbage.</p>
<p><em>Binary acceleration</em> (still looking for better name) bypasses the deserialization,
and performs binary search directly over binary data.
So far it is 3x faster over deserialization, but that will probably improve even more.</p>
<p>Less visible change is elimination of <code class="docutils literal"><span class="pre">BTreeKeySerializer</span></code> class. Its functionality was merged into <code class="docutils literal"><span class="pre">Serializer</span></code> class.
Now there will be names such as <code class="docutils literal"><span class="pre">Serializer.STRING_DELTA</span></code> (common prefix compression).</p>
</div>
<div class="section" id="sortedtablemap">
<h2>SortedTableMap<a class="headerlink" href="#sortedtablemap" title="Permalink to this headline">¶</a></h2>
<p>There is new and shiny``SortedTableMap``. It takes lot of ideas and code from <code class="docutils literal"><span class="pre">BTreeMap</span></code>
(delta compression, binary acceleration, value packing...) and is also inspired by Sorted String Tables from Cassandra.</p>
<p>Instead of directory it uses faster binary search over table. It is faster, but read-only.
It uses fixed-size pages, but supports variable length entries, compression and is fairly space efficient.</p>
<p>It was inspired by Cassandra SSTables and is designed around Data Pump.
Eventually it will support modifications by using secondary writeable map, and periodical merging of both maps.
I would like provide Map implementation which will make this process completely transparent to user.</p>
<p>So far <code class="docutils literal"><span class="pre">SortedTableMap</span></code> seems to be 5x faster compared to old <code class="docutils literal"><span class="pre">BTreeMap</span></code>.
Again, that is not final number yet, I have not started optimizing code yet.</p>
</div>
<div class="section" id="benchmarks">
<h2>Benchmarks<a class="headerlink" href="#benchmarks" title="Permalink to this headline">¶</a></h2>
<p>Here are <a class="reference external" href="https://github.com/jankotek/mapdb/tree/mapdb3/mapdb-benchmark/src/test/java/org/mapdb/benchmark">quick benchmark</a>
results. It shows Map.get() on Map&lt;Integer,Integer&gt; with 10 million entries.</p>
<p>MapDB 3.0 is faster compared to older MapDB 2.0.
3.0 is not yet optimized and with default setting. I expect its numbers will improve at least 2x.</p>
<div class="code xml highlight-python"><div class="highlight"><pre><span></span><span class="n">ConcurrentHashMap_get</span> <span class="o">-</span> <span class="mi">282</span>
<span class="n">ConcurrentSkipListMap_get</span> <span class="o">-</span> <span class="mi">2211</span>

<span class="n">BTreeMap_get</span> <span class="o">-</span> <span class="mi">17054</span>
<span class="n">HTreeMap_get</span> <span class="o">-</span> <span class="mi">22214</span>
<span class="n">SortedTableMapBenchmark_get</span> <span class="o">-</span> <span class="mi">7069</span>

<span class="n">MapDB2_BTreeMap_get</span> <span class="o">-</span> <span class="mi">25886</span>
<span class="n">MapDB2_HTreeMap_get</span> <span class="o">-</span> <span class="mi">43968</span>
</pre></div>
</div>
<p>Proper benchmarks will be provided in a few weeks after M3.</p>
</div>
<div class="section" id="roadmap">
<h2>3.0 Roadmap<a class="headerlink" href="#roadmap" title="Permalink to this headline">¶</a></h2>
<p>Current M2 has severe limitations, most notably it does not allow to reopen DB files.
But so far it delivered and verified most architectural changes needed for 3.0 release.</p>
<p>Right now 3.0 is two weeks behind schedule. Almost stable release-candidate is expected at end of March.
This date is fixed, and I will not compromise on quality, so some features might be postponed for latter release.</p>
<p>Next week there will be new <code class="docutils literal"><span class="pre">2.0-beta13</span></code> and <code class="docutils literal"><span class="pre">1.0.9</span></code> releases. Those will probably be the last
releases for 1.x and 2.x branches. I will migrate issue list to 3.0 and close old bugs.
After that support for older branches will be minimal (pull requests, critical bugs etc..).</p>
<p>Milestone 3 is expected in about ten days. Main goal is to port features, unit tests, documentation etc from older
branches. MapDB 3 will become much more usable in this milestone.
Also 3.0 branch will become master branch on Github and Mapdb.org website.</p>
<p>Milestone 4 will finalize and freeze API and storage format specification. It will also introduce crash resistance
for Write Ahead Log. It will also add some extra collections (IndexedTreeList, Deque...).
M4 is expected at beginning of March.</p>
<p>Milestone 5 will fix bugs and improve performance. Main focus will be on
unit tests and benchmarks. It will be released in March.</p>
<p>M5 should be followed by 3.0.0 release candidate.</p>
</div>
<div class="section" id="features-not-in-3-0">
<h2>Features not in 3.0<a class="headerlink" href="#features-not-in-3-0" title="Permalink to this headline">¶</a></h2>
<p>Here is list of features, which might not be in 3.0 release:</p>
<ul class="simple">
<li><strong>Concurrent Transactions</strong> (aka TxMaker). Doing it right is quite complicated.  I decided to move it
into separate release. It will support MVCC and usual goodies,
I think I will use Java Transaction API and will be in separate subproject.</li>
<li><strong>Instance Caches</strong> are practically made obsolete by Binary Acceleration. With extra dependencies
we also have access to more sophisticated caching algorithms (LIRS). Instance Caches will be added in latter release.</li>
<li><strong>Serializer POJO</strong> is general serializer for DB object. If you specify no serializer while creating map,
this one will be used. This is pretty solid serialization framework. I decided to move it into independent project
outside MapDB. It will be usable as standalone and will be optional dependency for MapDB.
Not sure if it will be done on time, so MapDB 3.0 might be without default serializer. That means serializer definition will be always required.</li>
</ul>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  Previous: 
  <a href="../thread_weaver/">
    
    Unit testing multi-threaded code with Thread Weaver
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  Next: 
  <a href="../../changelog-archive/#beta13-released-2016-02-21">
    2.0-beta13 released (2016-02-21)
    
  </a>
  </span>
  
</div>

  
  
    <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'mapdb';
        var disqus_identifier = '/news/m2_and_roadmap/';
        var disqus_title = 'Milestone 2 is out and 3.0 roadmap';
        var disqus_url = 'http://www.mapdb.org/news/m2_and_roadmap';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, jan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>